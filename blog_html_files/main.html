<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Part 1</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <link rel="stylesheet" href="css/normalize.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/cayman.css">
    <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
  </head>
  <body>

    <style>
    #right_div {
    float: right;
    border: 0px solid black;
    text-align: center;
}
</style>


    <section class="page-header">
      <br>
      <br>
      <h1 class="project-name">Long Short Term Memory</h1>
      <h2 class="project-tagline">Part 1: Motivation, History, Theory, & Application</h2>
      <h3 class="project-tagline">By: Adam Lieberman, Ravish Chawla, & Garrett Mallory</h3>
      <br>
      <br>
      <!--<a href="#" class="btn">View on GitHub</a>
      <a href="#" class="btn">Download .zip</a>
      <a href="#" class="btn">Download .tar.gz</a> -->
    </section>

    <section class="main-content">
    <h1>Motivation</h1>
   	<p>Suppose you are trying to train a neural network to understand the following sentence:</p>
   	<blockquote>
   		<p>"Ryan drove the car."</p>
   	</blockquote>
   	<p>This sentence clearly has a different connotation from the following sentence:</p>
   	<blockquote>
   		<p>"The car drove Ryan."</p>
   	</blockquote>
   	<p>The human brain immideatly recognizes these difference. We can tell that in the first sentence a human drove the car, but in the second sentence there must be some artifical intelligence going on because the car is driving the human. Our brains have neurons with feedback connections, which can learn many behaviors and sequencing tasks. Thus, we can pick up on these differences very easily because we read each word in the sentence sequentially. We are picking up the context of each word from the words before it. Traditional neural networks would not differentiate the above two sentences, but a special type of network called a Long Short-Term Memory Network, a type of recurrent neural network, would be able to differentiate these two sentences. These types of networks are great for sequential taks like stock market prediction, music generation, speech recognition, and language detection.</p>
    
    <h1>Prerequisites</h1>
    <p>Before we talk about Long Short-Term Memory Networks, let us briefly cover a few prerequisites:</p>
    <h4>Feed Forward Neural Networks:</h4>
    <p>The goal of a feed forward neural network is to approximate some function $f^*$. For example, let $y = f^*(x)$ be a classifier which maps $x$ to a category $y$. The feed forward network defines a mapping $f(x;\theta) \rightarrow y$, which we can express as $f(x;\theta) = y$. This mapping learns the values of parameters of $\theta$, which result in the best approximation to the function $f^*$.</p>
    <p>A feed forward network has inputs passing through hidden layers to generate outputs. Here, signals can only travel in the direction from input to output. The output layer does not affect the same or any other layer. We see an example as follows:</p>
    <center><img src="../images/feed_forward_nn.png" style="width:300px"></center>
    <p>Above, we see that the input passes through the hidden layer which is then connected to the output layer to generate the outputs. The information is fed straight through, from left to right, never touching a given node twice.</p>  

    <h4>Recurrent Neural Networks:</h4>
    <p>Recurrent neural networks (RNNs) are a family of neural networks for processing sequential data, a sequence of values $x^{(1)},x^{(2)},...,x^{(t)}$. In a traditional neural network, like the feed forward network above, we assume that all inputs and outputs are independent of each other. This is not the case for all tasks. If we are building a chat bot and want to predict the next word in reply, we need to know the words that came before it. Essentially, RNNs have memory. Every element in the sequence has the same task performed on it, with the output being dependant on the previous computations. An RNN looks as follows:</p>
    <center><img src="../images/RNN-unrolled.png"></center>
    <p>Here, we see that the sample $x_t$ is generated based on $x_0, x_1, ..., x_{t-1}$ and the output, $h_t$, is dependent on what comes before it. We see that the network forms loops. The first input is passed into its hidden layer and generates some output $h_0$. The second sequential input is passed into its hidden layer and so is the output from $h_0$. The activation function in hidden layer $h_1$ is activated on the second sample and this is then added with $h_0$. This process is then repeated until the last item in the sequence $x_t$. Traditionally, we depict this nature in the following image:</p> 
    <center><img src="../images/RNN-rolled.png" style="height:180px"></center>
    <p>In the 1990's the vanishing gradient problem emerged as a major obstacle to RNN performance. The gradient expresses the change in all weights with respect to the change in error. Thus, not knowing the gradient foes not allow us to adjust the weigths in a direction taht will reduce the error. If we can't do this then the network will not learn. If any quantity is multiplied by a slightly larger quantity in a repeated fashion, the quantity can become very large. This is also true for the reverse case. If we multiply a quantity repeatedly by a quantity less than one, the quantity will become infitesimal. If this is hard to see, imagine that you are a gambler. You keep betting 1 dollar, but win 97 cents on that dollar every bet. You will soon see that this is not sustainable and you will go bankrupt very soon. The layers and timesteps in an RNN relate to each other through multiplication so the derivatives are susceptible to explosion or vanishing. For instance, let us look at multiple applications of the sigmoid in a repeated fashion:</p>
    <center><img src="../images/sigmoid_repeat.png" style="width:400px"></center>
    <p>The sigmoid activation function is a popular activation in RNN's. We see here that the slope of the data becomes negligble and hence undetectable, thus vanishing.</p>
    <p>RNN's were a great achievement. They were able to learn on sequential data where feed forward networks failed, but do suffer from the vanishing gradient problem.</p>

    <h1>History of the LSTM</h1>
    <p>In 1991, Dr. JÃ¼rgen Schmiduber and his former PhD student Sepp Hochreiter proposed a feedback network to overcome the vanishing and exploding gradient problem found with RNNs. In 1997, Schmidhuber and Hochreiter published the paper <a href="http://www.bioinf.jku.at/publications/older/2604.pdf">Long Short-Term Memory</a>. In this paper they reivew Hochreiter's 1991 analysis of the problem of insufficient decaying error back flow in recurrent backpropogation. They combatted this problem by introducing the Long Short-Term Memory (LSTM). In the 90's, computing was still expensive and computing resources were not advanced, so LSTMs were not widely adopted. Fast forward 10 years and services like Amazon AWS and Microsoft Azure offered inexpensive computing which brought massive attention to LSTMs.</p>    
    <h1>What are LSTMs?</h1>
    <p>Long Short-Term Memory networks are a type of recurrent neural network, which overcome the vanishing gradient problem found in a regular RNN. They typical LSTM has 3 main gates and a cell unit:</p>
    <ul>
    <li><b>Input Gate: </b>The input gate controls how much of the newly computed state for the current input that you want to let through.</li>
    <li><b>Forget Gate: </b>The forget gate defines how much of the previous state you want to let through.</li>
    <li><b>Output Gate: </b>The output gate defines how much of the interant state you want to expose to the external network.</li>
    </ul>
    <p>Mathematically, we can define these gates as equations as follows:</p>
    $$i_t = g(W_{x_i}x_t + W_{h_i}h_{t-1}+b_i)$$
    $$f_t = g(W_{x_f}x_t + W_{h_f}h_{t-1}+b_f)$$
    $$o_t = g(W_{x_o}x_t+W_{h_o}h_{t-1}+b_o)$$
    <p>Above, $i_t$ is the input gate, $f_t$ is the forget gate, $o_t$ is the output gate, $g$ is a sigmoid activation function, $W$ represents a particular weight, and $b$ is a bias.</p>
    <p>The cell unit can be transformed as:</p>
    $$ c_{in_t} = \text{tanh}\left(W_{xc}x_t + W_{hc}h_{t-1}+b_{c_{in}}\right)$$
    <p>where $h_t = o_t \cdot \text{tanh} \left(c_t\right)$. The state can then be updated as:</p>
    $$c_t = f_t \cdot c_{t-1} + i_t \cdot c_{in_t}$$
    <p>We can depict all of these equations graphically as:</p>
    <center><img src="../images/LSTM.png" style="width:350px"></center>
    <p>The gating allows the cell to keep pieces of information for prolonged periods of time while protecting the gradient inside the cell during training. This ensures that the gradient does not explode or vanish from multiple activations being processed.</p>
    <!--<li><b>Cell Unit: </b>Here, information can be stored in, written to, or read from a cell. This is similar to memory in a computer. This cell makes decisions on what to store, when to read, when to write, and when to erase through gates that open and close.</li> -->
    

    <h1>Applications:</h1>
    <ul>
    <li>Image Captioning - Oriol Vinyas, Alexander Toshev, Samy Bengio, and Dumitru Erhan published <a href="https://arxiv.org/pdf/1411.4555v2.pdf">Show and Tell: A Neural Image Caption Generator</a>. This paper uses an LSTM to automatically describe the content of an image.</li>
    <br>
    <li>Hand Writing Generation - In 2014, Alex Graves published <a href="https://arxiv.org/pdf/1308.0850v5.pdf">Generating Sequences With Recurrent Neural Networks</a>. In this paper an LSTM model was used to generate handwriting from text. The handwriting was shown to be realistic cursive in a wide variety of styles.</li>
    <br>
    <li>Stock Market Prediction - Tal Perry published the article <a href="https://medium.com/@TalPerry/deep-learning-the-stock-market-df853d139e02">Deep Learning the Stock Market</a>. Here he used an LSTM to predict market prices.</li>
    <br>
    <li>Movie Reviews - Jason Brownley published <a href="http://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/">Sequence Classification with LSTM Recurrent Neural Networks in Python with Keras</a> where he uses an LSTM to classify IMDB movie sentiment.</li>
    <br>
    <li>Image Generation - In 2015, the Google DeepMind team published <a href="https://arxiv.org/pdf/1502.04623v2.pdf">DRAW: A Recurrent Neural Network For Image Generation</a>. This paper introduces the Deep Recurrent Attentive Writer, DRAW, which generates MNIST digits. DRAW was build with an LSTM layer.</li>
    <li>Reddit Comment Generator - Braulio Chavez published <a href="https://cs224d.stanford.edu/reports/Chavez.pdf">Reddit Comment Generator</a> where he used LSTM cells to generate comments on Reddit.</li>
    </ul>

    <h1>Improving Performance of LSTMs:</h1>
    <p>To improve the performance of LSTMs we can attempt to do some of the following:</p>
    <ul>
    <li>Adding Regularization - Use l1, l2, or dropout layers.</li>
    <br>
    <li>Bias - Adding a bias of 1 in every neuron in an LSTM layer has been noted to improve performance, drastically in some cases.</li>
    <br>
    <li>Activation - Use softsign activation funvtion over tanh. Also try softsign over softmax.</li>
    <br>
    <li>Optimizers - RMSProp and AdaGrad are good choices for optimizers.</li>
    <br>
    <li>Learning Rate - This parameter is very important, a well tuned learning rate can drastically improve performance.</li>
    <br>
    <li>Data - Normalizing data can help. Also more data is always better because it helps combat overfitting.</li>
    </ul>    
    <!--<h1>Research Problems:</h1> -->
    
 


    <h1>Building our own LSTM:</h1>
    <p>Now that we have some background on LSTMs, let us build an LSTM for language detection. Hit the button below to jump to the next tutorial where we construct this LSTM using python, tensorflow, and keras.</p>
    <!--<p>Now that we understand what a generative adversarial network is and how it works, let's proceed by creating our own GAN. We will specifically implement a deep convolutional generative adversarial network (DCGAN) and generate facial images like we described in the motivating example. For this post click the button below.</p> -->
    <style>
      .myButton {
        background-color:#44c767;
        -moz-border-radius:28px;
        -webkit-border-radius:28px;
        border-radius:28px;
        border:1px solid #18ab29;
        display:inline-block;
        cursor:pointer;
        color:#ffffff;
        font-family:Arial;
        font-size:17px;
        padding:16px 31px;
        text-decoration:none;
        text-shadow:0px 1px 0px #2f6627;
      }
    .myButton:hover {
      background-color:#5cbf2a;
      }
    .myButton:active {
      position:relative;
      top:1px;
      }
  </style>
  <center><a href="main2.html" class="myButton">Let's Build an LSTM</a></center>


    <h1>References</h1>
    <ul>
    <li>Images:</li>
    <ul>
    <li>Image 1 - http://coderoncode.com/machine-learning/2017/03/26/neural-networks-without-a-phd-part2.html</li>
    <li>Image 2 - http://colah.github.io/posts/2015-08-Understanding-LSTMs/</li>
    <li>Image 3 - http://colah.github.io/posts/2015-08-Understanding-LSTMs/</li>
    <li>Image 4 - https://deeplearning4j.org/lstm.html</li>
    <li>Image 5 - https://apaszke.github.io/lstm-explained.html</li>
    </ul>
    <li>Content:</li>
    <ul>
    <li>http://www.deeplearningbook.org/contents/rnn.html</li>
    <li>http://www.wildml.com/2015/10/recurrent-neural-network-tutorial-part-4-implementing-a-grulstm-rnn-with-python-and-theano/</li>
    <li>https://deeplearning4j.org/lstm.html</li>
    <li>http://colah.github.io/posts/2015-08-Understanding-LSTMs/</li>
    <li>https://en.wikipedia.org/wiki/Long_short-term_memory</li>
    </ul>
    </ul>
   
    </section>

  </body>
</html>
